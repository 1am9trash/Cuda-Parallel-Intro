import matplotlib.pyplot as plt
import numpy as np

data = {
    "L=8": ([1.732051, 3.464102, 5.196152, 6.928203], [0.026040, 0.005901, 0.000695, 0.000000]),
    "L=16": ([1.732051, 3.464102, 5.196152, 6.928203, 8.660254, 10.392305, 12.124356, 13.856406],
             [0.034860, 0.013960, 0.006630, 0.003100, 0.001257, 0.000367, 0.000046, 0.000000]),
    "L=32": ([1.732051, 3.464102, 5.196152, 6.928203, 8.660254, 10.392305, 12.124356, 13.856406,
              15.588457, 17.320508, 19.052559, 20.784610, 22.516660, 24.248711, 25.980762, 27.712813],
             [0.039229, 0.018303, 0.010874, 0.007109, 0.004850, 0.003358, 0.002317, 0.001569,
              0.001026, 0.000637, 0.000365, 0.000186, 0.000078, 0.000023, 0.000003, 0.000000]),
    "L=64": ([1.732051, 3.464102, 5.196152, 6.928203, 8.660254, 10.392305, 12.124356, 13.856406,
              15.588457, 17.320508, 19.052559, 20.784610, 22.516660, 24.248711, 25.980762, 27.712813,
              29.444864, 31.176915, 32.908965, 34.641016, 36.373067, 38.105118, 39.837169, 41.569219,
              43.301270, 45.033321, 46.765372, 48.497423, 50.229473, 51.961524, 53.693575, 55.425626],
             [0.041405, 0.020478, 0.013046, 0.009273, 0.006996, 0.005474, 0.004386, 0.003571,
              0.002938, 0.002434, 0.002023, 0.001684, 0.001401, 0.001162, 0.000959, 0.000787,
              0.000640, 0.000515, 0.000409, 0.000319, 0.000245, 0.000183, 0.000133, 0.000093,
              0.000063, 0.000039, 0.000023, 0.000012, 0.000005, 0.000001, 0.0000002, 0.0000000])
}

# Coulomb's Law curve (excluding r = 0)
r_vals = np.linspace(1.5, 56, 500)
phi_theoretical = 1 / (4 * np.pi * r_vals)

# Plotting
plt.figure(figsize=(6, 4))
for label, (r, phi) in data.items():
    plt.plot(r, phi, marker='o', label=label)

plt.plot(r_vals, phi_theoretical, linestyle='--', color='black', label="Coulomb's Law (1/4πr)")

plt.xlabel("r (lattice units)")
plt.ylabel("Φ")
plt.title("Discrete Poisson vs. Coulomb Potential")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig("poisson.png", dpi=400)

